<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Quiz Online - Aluno</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <h1>üìù Teste Online</h1>

    {% if lista_questoes %}
        <form action="/aluno/corrigir_teste" method="POST">
            
            {% for q in lista_questoes %}
            <div class="questao-card" style="margin-bottom: 30px; text-align: left;">
                
                <h3 class="enunciado-estilo">{{ loop.index }}. {{ q[1] }}</h3>

                <label class="opcao-bloco">
                    <input type="radio" name="resposta_{{ q[0] }}" value="A" required> 
                    <strong>A)</strong> {{ q[2] }}
                </label>

                <label class="opcao-bloco">
                    <input type="radio" name="resposta_{{ q[0] }}" value="B"> 
                    <strong>B)</strong> {{ q[3] }}
                </label>

                <label class="opcao-bloco">
                    <input type="radio" name="resposta_{{ q[0] }}" value="C"> 
                    <strong>C)</strong> {{ q[4] }}
                </label>

                <label class="opcao-bloco">
                    <input type="radio" name="resposta_{{ q[0] }}" value="D"> 
                    <strong>D)</strong> {{ q[5] }}
                </label>
            </div>
            <hr>
            {% endfor %}

            <button type="submit" class="btn-verde">Finalizar Teste</button>
        </form>

    {% else %}
        <div class="alerta">
            <p>Ainda n√£o existem quest√µes cadastradas pelo professor.</p>
            <a href="/" class="btn-vermelho">Voltar</a>
        </div>
    {% endif %}
</div>

<div class="container">
    <div id="cronometro-container" style="position: sticky; top: 10px; background: #333; color: #fff; padding: 15px; border-radius: 10px; text-align: center; font-size: 1.5em; z-index: 1000;">
        ‚è±Ô∏è Tempo restante: <span id="tempo">10:00</span>
    </div>

    <h1>üìù Teste Online</h1>

    <form id="formQuiz" action="/aluno/corrigir_teste" method="POST">
        
        {% for q in lista_questoes %}
            {% endfor %}

        <button type="submit" class="btn-verde">Finalizar Teste ‚úÖ</button>
    </form>
</div>

<script>
    // Define o tempo inicial: 10 minutos em segundos
    let tempoEmSegundos = 10 * 3; 

    const display = document.querySelector('#tempo');
    const formulario = document.querySelector('#formQuiz');

    const cronometro = setInterval(function () {
        let minutos = Math.floor(tempoEmSegundos / 60);
        let segundos = tempoEmSegundos % 60;

        // Formata√ß√£o para ter sempre dois d√≠gitos (ex: 05:09)
        minutos = minutos < 10 ? '0' + minutos : minutos;
        segundos = segundos < 10 ? '0' + segundos : segundos;

        display.textContent = minutos + ":" + segundos;

        // Quando o tempo chega a zero
        if (--tempoEmSegundos < 0) {
            clearInterval(cronometro);
            alert("O tempo acabou! O seu teste ser√° enviado automaticamente.");
            formulario.submit(); // Envia o formul√°rio sozinho!
        }

        // Estilo de alerta quando faltar menos de 1 minuto
        if (tempoEmSegundos < 60) {
            document.getElementById('cronometro-container').style.background = "#dc3545";
        }

    }, 1000); // Executa a cada 1 segundo
</script>
</body>
</html>